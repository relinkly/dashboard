<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZL & BVS Active Retail</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="icon-192.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- SheetJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <!-- Grid.js -->
  <link href="https://unpkg.com/gridjs/dist/theme/mermaid.min.css" rel="stylesheet" />
  <script src="https://unpkg.com/gridjs/dist/gridjs.umd.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background-color: #f9f9f9;
    }

    h1 {
      color: #007bff;
    }

    .tag {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 1rem;
    }

    .buttons {
      margin-top: 2rem;
    }

    select {
      padding: 6px;
      margin-top: 10px;
    }

    .gridjs {
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h1>ZL & BVS Active Retail</h1>
  <p class="tag">ðŸ“… Updated till <strong>23/07/2025</strong></p>

  <label for="sheet-select"><strong>Select Sheet:</strong></label>
  <select id="sheet-select"></select>

  <div id="grid-wrapper"></div>

  <div class="buttons">
    <a href="menu.html">ðŸ”™ Back to Menu</a>
  </div>

  <script>
    // Protect dashboard
    if (localStorage.getItem("authenticated") !== "true") {
      window.location.href = "index.html";
    }

    const sheetSelect = document.getElementById('sheet-select');
    const gridWrapper = document.getElementById('grid-wrapper');

    fetch('ZL_BVS_Active_Retail.xlsx')
      .then(res => res.arrayBuffer())
      .then(data => {
        const workbook = XLSX.read(data, { type: 'array' });

        // Populate dropdown
        workbook.SheetNames.forEach(name => {
          const opt = document.createElement('option');
          opt.value = name;
          opt.textContent = name;
          sheetSelect.appendChild(opt);
        });

        // Render the selected sheet
        function renderSheet(sheetName) {
          const sheet = workbook.Sheets[sheetName];
          const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

          // Get header + rows
          const [header, ...rows] = jsonData;

          // Clear previous table
          gridWrapper.innerHTML = "";

          // Render table
          new gridjs.Grid({
            columns: header,
            data: rows,
            search: true,
            pagination: {
              limit: 15
            },
            sort: true,
            resizable: true,
            className: {
              table: 'gridjs-table'
            }
          }).render(gridWrapper);
        }

        // Load first sheet
        renderSheet(workbook.SheetNames[0]);

        // When user selects a new sheet
        sheetSelect.addEventListener('change', e => {
          renderSheet(e.target.value);
        });
      });
  </script>
</body>
</html>
